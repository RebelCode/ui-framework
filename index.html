<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>booking-str</title>
  </head>
  <body>
    <div id="app"></div>
    <div id="new-app">
      <hello inline-template>
        <span>
          {{ translate('Test') }}
        </span>
      </hello>
    </div>

    <div class="next-app">
      <hello inline-template>
        <span>
          {{ translate('Test') }}
        </span>
      </hello>
    </div>

    <div class="next-app">
      <hello inline-template>
        <span>
          {{ translate('Test') }}
          <calendar :events="[{title: 'Sunny Out of Office',start: '2017-08-25',end: '2017-07-27'}]"
                    locale="en"></calendar>
        </span>
      </hello>
    </div>

    <script>
      document.addEventListener('DOMContentLoaded', function () {
        // get default configuration inside the Bottle instance
        require.config({
          paths: {
            textFormatter: 'https://unpkg.com/sprintf-js@1.1.1/dist/sprintf.min',
            bottle: 'https://cdnjs.cloudflare.com/ajax/libs/bottlejs/1.6.1/bottle.min',
            vue: 'https://cdnjs.cloudflare.com/ajax/libs/vue/2.5.4/vue',
            calendar: 'https://cdn.jsdelivr.net/npm/vue2-full-calendar@1.0.15/dist/vue-fullcalendar.min'
          }
        });

        function defineServices (di, dependecies) {
          di.factory('translator', function () {
            return new dependecies.UiFramework.I18n.FormatTranslator(dependecies.textFormatter.sprintf)
          })
          di.factory('translate', function (container) {
            return function (format, params, context) {
              return container.translator.translate(format, params)
            }
          })
          di.factory('selectorList', function () {
            return [
              '#app',
              '#new-app',
              '.next-app'
            ]
          })

          di.factory('calendar', function () {
            return dependecies.calendar
          })

          di.factory('hello', function () {
            return {
              inject: ['translate', 'calendar'],
              components: {
                calendar: 'calendar'
              }
            }
          })

          di.factory('components', function (container) {
            return {
              hello: container.hello,
              calendar: container.calendar
            }
          })

          di.factory('document', function () {
            return document
          })
          di.factory('vue', function () {
            return dependecies.vue
          })
        }

        require(['ui-framework', 'textFormatter', 'bottle', 'vue', 'calendar'], function(UiFramework, textFormatter, bottle, vue, calendar) {
          var di = new bottle()
          defineServices(di, {
            bottle: bottle,
            UiFramework: UiFramework,
            textFormatter: textFormatter,
            vue: vue,
            calendar: calendar
          })
          var container = new UiFramework.Container.Container(di)
          var NewApp = new UiFramework.Core.App(container)
          NewApp.init()
        });
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.5/require.js"></script>
  </body>
</html>
